# 在鹿上大作业分析设计文档

<div class="author">
    <span>在鹿上组：</span>
    <span>李嘉尧</span>
    <span>常佳庆</span>
    <span>沈诣博</span>
    <span>章志宇</span>
    <span>刘航</span>
</div>

##   需求分析

### 应用背景

​	目前在各大高校中，通常使用传统的方式如签到表，刷卡和刷脸进行学生签到统计，这些传统方式各有弊端。签到表较耗费人力资源，且容易出现代签，漏签的情况；刷卡虽然操作简单，但是容易出现代刷；刷脸虽然先进而且方便，但是容易出现一堆人排队刷脸，等待时间长的问题，且需要较高的硬件成本。

​	声纹识别技术，随着人工智能的发展已经日趋成熟，它具有低成本、高安全、弱隐私的优点，可以有效解决以上的问题。

### 应用场景

​	预期应用场景是大学生课堂签到，使用用户为课程的教师、学生、以及管理课程、学生、教师相关信息的教务。

### 基本功能需求

​	核心功能是实现课程签到。管理员可以添加课程、用户、学生，以保证基本的签到要素。学生可以在有效范围中完成上课的签到，系统记录每节课程课程的签到情况。教师可以查询到其任教课程学生的签到情况，考虑特殊情况，如果学生无法通过声纹正常签到，可以通过教师允许后，在教师端对学生进行补签到。可以以统计图表的方式对考勤情况进行展示，方便对课程考勤情况进行简单的管理和统计。

​	三级用户，第一级用户是教务即管理员，能够注册课程，确定课程的相关信息，包括课程时间，地点，以及课程的教师学生名单，对学生教师的信息进行增删查改。第二级用户是教师，可以查看自己任教课程的信息和签到情况。第三级用户是学生，可以对自己目前所在的课程和历史签到情况进行查看，并对目前正在进行的课程执行签到操作。

#### 签到功能

​	签到有两种方案 ：集中式签到和分布式签到。

​	集中式签到是指利用公用终端，排队进行签到，类似门禁一样，该方法不需要使用蓝牙设备定位，学生需要在规定时间在规定地点，利用规定终端完成验证。但这一方案最终被抛弃，因为与传统方案相比，完全无法体现出声纹签到的优势所在，排队现象比起人脸识别甚至会更加严重。

​	分布式签到是利用分布式的终端，规定时间规定地点进行签到。由于分布设备的移动性，该方案需要使用蓝牙定位设备，以保证签到是在规定的地点进行的。这一分布式方案，可以使用目前常见的移动端设备如手机，来进行签到验证。开发可以选用微信小程序或者APP，这一方案更符合实际需求，我们最终选定的方案是分布式签到这种方案。

#### 在线管理平台 / web 端

​	为方便管理，将管理员端/教师端的操作放在web端上，以方便在教务管理以及教师在课堂上使用电脑操作。

- 管理员
  - 管理课程信息，教师信息，学生信息
  - 管理教师账户，学生账户
  - 管理考勤记录
  - 批量上传，添加学生、教师、课程
- 教师
  - 查看任教课程信息
  - 查看课程签到情况
  - 补签到功能

#### 签到应用/安卓端

​	安卓端不只是单纯的学生端，同时也应支持教师端的功能，以方便一些课堂中没有使用电脑习惯的教师操作，如一些喜欢板书的教师和体育课。

- 教师
  - 查看任教课程信息
  - 查看课程签到情况
  - 补签到功能
- 学生
  - 查看所在课程信息
  - 对当前课程进行声纹签到
  - 查看本人考勤记录

### 泳道图

![image-20200107194641839](.\img\image-20200107194641839.png)



根据分析，可以画出这样的泳道图。这是一个比较典型的Client-Server模式，最终我们采用的也是这样的实现方式，前后端完全分离，将管理员，教师，学生的操作交给前端来处理，而后端则是对前端的请求进行处理操作，仅暴露相关接口给前端调用。

## 模块接口设计

### Web端

web端采用vue框架开发，整体的组件组成如下图

<img src="C:\Users\15039\AppData\Roaming\Typora\typora-user-images\1578380550592.png" alt="1578380550592" style="zoom: 50%;" />

#### 登录界面

| 函数名 | 参数         | 功能描述                                                     |
| ------ | ------------ | ------------------------------------------------------------ |
| login  | 用户名和密码 | 调用服务器接口，获取用户的信息和Token，保存到本地浏览器的会话存储中，根据用户的类型进入相应的主界面 |

#### 管理员界面

###### 课程信息

| 函数名                | 参数     | 功能描述                                                     |
| --------------------- | -------- | ------------------------------------------------------------ |
| getData               |          | 通过管理员id和登录时获得的token，调用服务器接口，返回所有的课程列表 |
| GetCourseDetail       | 课程id   | 根据课程id，跳转到对应的课程详情页                           |
| submitAddCourseDialog |          | 调用服务器接口，将前端输入的课程信息发送至服务器，添加课程   |
| submitEditDialog      |          | 调用服务器接口，将前端更改的课程信息发送至服务器，修改课程信息 |
| DeleteCourse          | 课程对象 | 调用服务器接口，根据参数的课程id，删除课程                   |
| onUploadSuccess       | 文件对象 | 在文件上传成功后，对上传的文件进行处理，得到其中所有的课程信息 |
| submitFileDialog      |          | 调用服务器接口，将上传的文件中的课程信息发送至服务器，批量添加课程 |
| DisplayCourseInfo     | 课程对象 | 根据参数的课程id，调用服务器接口，获得该课程的所有学生列表   |
| addStudentToCourse    |          | 根据前端选择的学生的id，调用服务器接口，向课程中添加学生     |
| deleteStudentInCourse |          | 根据前端选择的学生的id，调用服务器接口，删除课程中的学生     |
| EditCourseTimeDialog  | 课程对象 | 根据参数的课程id，调用服务器接口，获得该课程的所有上课时间   |
| addTimeToCourse       |          | 根据前端输入的时间，调用服务器接口，添加课程的时间           |
| deleteTimeInCourse    |          | 根据前端选中的时间，调用服务器接口，删除课程的时间           |

###### 用户信息

| 函数名                  | 参数     | 功能描述                                                     |
| ----------------------- | -------- | ------------------------------------------------------------ |
| getData                 |          | 通过管理员id和登录时获得的token，调用服务器接口，返回所有的用户列表 |
| submitAddTeacherDialog  |          | 调用服务器接口，将前端输入的信息提交到服务器，添加教师       |
| submitAddStudentDialog  |          | 调用服务器接口，将前端输入的信息提交到服务器，添加学生       |
| onUploadSuccess         | 文件对象 | 在文件上传成功后，对上传的文件进行处理，得到其中所有的用户信息 |
| submitFileDialog        |          | 调用服务器接口，将上传的文件中的用户信息发送至服务器，批量添加课程 |
| submitEditTeacherDialog |          | 调用服务器接口，将前端输入的教师信息提交到服务器，更改教师信息 |
| submitEditStudentDialog |          | 调用服务器接口，将前端输入的学生信息提交到服务器，更改学生信息 |
| DisplayTeacherInfo      | 教师对象 | 根据参数的教师id，调用服务器接口，获得该教师所教的所有课程   |
| DisplayStudentInfo      | 学生对象 | 根据参数的学生id，调用服务器接口，获得该学生所在的所有课程   |
| deleteTeacher           | 教师对象 | 根据参数的教师id，调用服务器接口，删除教师账户               |
| deleteStudent           | 教师对象 | 根据参数的学生id，调用服务器接口，删除学生账户               |

###### 考勤信息

| 函数名         | 参数     | 功能描述                                                     |
| -------------- | -------- | ------------------------------------------------------------ |
| getData        |          | 通过管理员id和登录时获得的token，调用服务器接口，返回所有的考勤记录 |
| openCourseInfo | 课程对象 | 调用服务器接口，通过参数的课程id获得该课程的所有签到记录     |
| openPersonInfo | 学生对象 | 调用服务器接口，根据参数的学生id获得该学生的所有签到记录     |

###### 课程详情

| 函数名                 | 参数     | 功能描述                                                     |
| ---------------------- | -------- | ------------------------------------------------------------ |
| getData                |          | 调用服务器接口，根据课程id获得该课程的详细信息               |
| signAStudent           | 学生对象 | 调用服务器接口，根据参数的学生id和课程id为学生补签到         |
| getStudent             |          | 调用服务器接口，根据课程id获得该课程的所有学生列表           |
| queryUnsigned          | 课程对象 | 调用服务器接口，根据课程id和开始时间获得该课程的所有未签到学生列表 |
| submitAddTimeDialog    |          | 调用服务器接口，将前端输入的课程时间提交到服务器，为该课程添加时间 |
| deleteTime             | 课程时间 | 调用服务器接口，删除课程被选中的课程时间                     |
| submitAddStudentDialog |          | 调用服务器接口，将前端输入的学生信息提交到服务器，为该课程添加学生 |
| deleteStudent          | 学生对象 | 调用服务器接口，删除课程被选中的学生                         |

#### 教师界面

| 函数名            | 参数 | 功能描述                                                     |
| ----------------- | ---- | ------------------------------------------------------------ |
| getCurrtime       |      | 获取当前系统时间并格式化处理                                 |
| getData           | key  | 如果key为1，根据教师id和登录时获取的token得到该教师所教的所有课程； 如果key为2，得到该教师当前正在上的课程 |
| DisplayCourseInfo |      | 进入课程详情页                                               |

​	